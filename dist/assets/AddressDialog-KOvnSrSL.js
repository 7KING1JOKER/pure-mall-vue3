import{_ as e}from"./PcMenu-BXBuAyN1.js";/* empty css                    *//* empty css                  */import{u as l}from"./index-BvqL1sXf.js";import{j as a,l as t,f as s,s as r,t as d,m as o,k as u,c as i,E as m}from"./element-plus-0hPO9ffS.js";import{y as p,r as n,c,l as g,w as v,H as f,I as b,u as V,A as _,Q as h,B as y,M as x}from"./vue-vendor-DGIvoex4.js";const w={class:"region-selects"},A={class:"dialog-footer"},U=e(p({__name:"AddressDialog",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:p}){const U=e,j=p,q=l(),k=n(),D=c({get:()=>U.modelValue,set:e=>j("update:modelValue",e)}),E=g({id:0,name:"",phone:"",province:"",city:"",district:"",street:"",detail:"",postcode:"",isDefault:!1}),M=g({name:[{required:!0,message:"请输入收货人姓名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],province:[{required:!0,message:"请选择省份",trigger:"change"}],city:[{required:!0,message:"请选择城市",trigger:"change"}],district:[{required:!0,message:"请选择区/县",trigger:"change"}],street:[{required:!0,message:"请输入详细地址",trigger:"blur"},{min:5,max:100,message:"长度在 5 到 100 个字符",trigger:"blur"}],postcode:[{required:!0,message:"请输入邮政编码",trigger:"blur"},{pattern:/^\d{6}$/,message:"请输入正确的邮政编码",trigger:"blur"}]});v(()=>q.currentAddress,e=>{e&&Object.assign(E,e)},{immediate:!0});const B=async()=>{k.value&&await k.value.validate(async(e,l)=>{if(e){if(!q.isEditingAddress){const e=q.addresses.length>0?Math.max(...q.addresses.map(e=>e.id)):0;E.id=e+1}E.detail=E.province+E.city+E.district+E.street;try{q.isEditingAddress?await q.updateAddress(q.username,E):await q.saveAddress(q.username,E),D.value=!1}catch(a){m.error("保存地址失败，请稍后重试")}}else m.error("请完善表单信息")})};return(e,l)=>{const m=s,p=t,n=d,c=r,g=o,v=u,U=i,j=a;return _(),f(j,{title:V(q).isEditingAddress?"编辑地址":"添加新地址",modelValue:D.value,"onUpdate:modelValue":l[9]||(l[9]=e=>D.value=e),width:"500px"},{footer:b(()=>[y("div",A,[h(U,{onClick:l[8]||(l[8]=e=>D.value=!1)},{default:b(()=>l[11]||(l[11]=[x("取消",-1)])),_:1,__:[11]}),h(U,{type:"primary",onClick:B},{default:b(()=>l[12]||(l[12]=[x("保存",-1)])),_:1,__:[12]})])]),default:b(()=>[h(v,{model:E,rules:M,ref_key:"addressFormRef",ref:k,"label-width":"80px","label-position":"right"},{default:b(()=>[h(p,{label:"收货人",prop:"name"},{default:b(()=>[h(m,{modelValue:E.name,"onUpdate:modelValue":l[0]||(l[0]=e=>E.name=e),placeholder:"请输入收货人姓名"},null,8,["modelValue"])]),_:1}),h(p,{label:"手机号码",prop:"phone"},{default:b(()=>[h(m,{modelValue:E.phone,"onUpdate:modelValue":l[1]||(l[1]=e=>E.phone=e),placeholder:"请输入手机号码"},null,8,["modelValue"])]),_:1}),h(p,{label:"所在地区",required:""},{default:b(()=>[y("div",w,[h(p,{prop:"province",class:"region-item"},{default:b(()=>[h(c,{modelValue:E.province,"onUpdate:modelValue":l[2]||(l[2]=e=>E.province=e),placeholder:"省份",style:{"min-width":"100px"}},{default:b(()=>[h(n,{label:"北京市",value:"北京市"}),h(n,{label:"上海市",value:"上海市"}),h(n,{label:"广东省",value:"广东省"}),h(n,{label:"江苏省",value:"江苏省"}),h(n,{label:"浙江省",value:"浙江省"})]),_:1},8,["modelValue"])]),_:1}),h(p,{prop:"city",class:"region-item"},{default:b(()=>[h(c,{modelValue:E.city,"onUpdate:modelValue":l[3]||(l[3]=e=>E.city=e),placeholder:"城市",style:{"min-width":"100px"}},{default:b(()=>[h(n,{label:"北京市",value:"北京市"}),h(n,{label:"上海市",value:"上海市"}),h(n,{label:"广州市",value:"广州市"}),h(n,{label:"深圳市",value:"深圳市"}),h(n,{label:"杭州市",value:"杭州市"})]),_:1},8,["modelValue"])]),_:1}),h(p,{prop:"district",class:"region-item"},{default:b(()=>[h(c,{modelValue:E.district,"onUpdate:modelValue":l[4]||(l[4]=e=>E.district=e),placeholder:"区/县",style:{"min-width":"100px"}},{default:b(()=>[h(n,{label:"朝阳区",value:"朝阳区"}),h(n,{label:"海淀区",value:"海淀区"}),h(n,{label:"东城区",value:"东城区"}),h(n,{label:"西城区",value:"西城区"}),h(n,{label:"丰台区",value:"丰台区"})]),_:1},8,["modelValue"])]),_:1})])]),_:1}),h(p,{label:"详细地址",prop:"street"},{default:b(()=>[h(m,{modelValue:E.street,"onUpdate:modelValue":l[5]||(l[5]=e=>E.street=e),type:"textarea",rows:2,placeholder:"请输入详细地址信息，如街道、门牌号等"},null,8,["modelValue"])]),_:1}),h(p,{label:"邮政编码",prop:"postcode"},{default:b(()=>[h(m,{modelValue:E.postcode,"onUpdate:modelValue":l[6]||(l[6]=e=>E.postcode=e),placeholder:"请输入邮政编码"},null,8,["modelValue"])]),_:1}),h(p,null,{default:b(()=>[h(g,{modelValue:E.isDefault,"onUpdate:modelValue":l[7]||(l[7]=e=>E.isDefault=e)},{default:b(()=>l[10]||(l[10]=[x("设为默认收货地址",-1)])),_:1,__:[10]},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}}),[["__scopeId","data-v-f4aa6d5c"]]);export{U as A};
